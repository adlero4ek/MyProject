entities:

  BusinessObjects:
    title: Бизнес сущность
    description: "Бизнес сущности - это представления реальных объектов деятельности. Они могут отображать
      - как физические объекты: помещения, активы, контракты
      - так и абстрактные понятия: сорта яблок, обращения клиентов."
    presentations:
      blank:
        title: Основная карточка бизнес сущности
        type: markdown
        template: templates/business_object_card.md
        source: >
          (
          
            $Datalake := $;
            
            $Query := $distinct(ApplicationDataObjects.$spread().(
            
              $AppDataObject_id := $keys()[0];
              
              *.business_Objects.(
              
                $BusinessObject_id := $;
                
                {
                  "AppDataObject_id": $AppDataObject_id,
                  "BusinessObject_id": $BusinessObject_id
                }
          
              );
            ))[BusinessObject_id=$params.id];

            $CountAppDataObject := $count($Query);
          
            $distinct(BusinessObjects.$spread().(
            
              $BusinessObject_id := $keys()[0];
              
              $.*.{
                "id": $BusinessObject_id,
                "title": title,
                "description": description,
                "type": type,
                "state": state,
                "state_update_date": state_update_date,
                "owner": owner,
                "division_owner": division_owner,
                "division_owner_link": "/architect/components/" & division_owner,
                "division_owner_title": $lookup($Datalake.components, division_owner).title,
                "count_app_data_obj": $CountAppDataObject
              };
              
              ))[id=$params.id]
          
          )